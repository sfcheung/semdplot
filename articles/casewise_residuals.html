<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="semdplot">
<title>Case Residuals Computation â€¢ semdplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Alegreya_Sans-0.4.5/font.css" rel="stylesheet">
<link href="../deps/Courier_Prime-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Residuals Computation">
<meta property="og:description" content="semdplot">
<meta property="og:image" content="https://sfcheung.github.io/semdplot/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">semdplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/semdplot.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/casewise_residuals.html">Case Residuals Computation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Case Residuals Computation</h1>
            
      
      
      <div class="d-none name"><code>casewise_residuals.Rmd</code></div>
    </div>

    
    
<p><strong>(Work-In-Progress)</strong></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is a technical appendix outlining how the data used to generate
the plots are computed.</p>
</div>
<div class="section level2">
<h2 id="computing-casewise-residuals">Computing Casewise Residuals<a class="anchor" aria-label="anchor" href="#computing-casewise-residuals"></a>
</h2>
<p>The function <code>casewise_residual()</code> first identifies the
<span class="math inline">\(x\)</span> variables: variables that have
point to at least one other variable, and <span class="math inline">\(y\)</span> variables, variables that that have at
least one other variable pointing to them. Note that a variable can in
both sets of variables (e.g., a mediator). It then enumerates all
pairwise combination of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables to see which of the following
cases they belong to:</p>
<div class="section level3">
<h3 id="free-or-or-fixed-to-nonzero-path">Free or or Fixed-To-Nonzero Path<a class="anchor" aria-label="anchor" href="#free-or-or-fixed-to-nonzero-path"></a>
</h3>
<p>If a path is free, or fixed to non-zero, then residuals of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are computed by predicting by all other
variables that predict <span class="math inline">\(y\)</span> in the
model. The regression coefficients are computed by</p>
<p><span class="math display">\[
\beta_{x} = \Sigma_{x0}^{-1}\Sigma_{(x0, x)},
\]</span> <span class="math display">\[
\beta_{y} = \Sigma_{x0}^{-1}\Sigma_{(x0, y)},
\]</span></p>
<p>where <span class="math inline">\(\Sigma_{x0}\)</span> is the
model-implied covariance of <span class="math inline">\(x0\)</span>, all
other variables that predict <span class="math inline">\(y\)</span>, and
<span class="math inline">\(\Sigma_{(x0, x)}\)</span> is a column vector
of model-implied covariance between <span class="math inline">\(x\)</span> and <span class="math inline">\(x0\)</span>. Similarly, <span class="math inline">\(\Sigma_{(x0, y)}\)</span> is a column vector of
model-implied covariance between <span class="math inline">\(y\)</span>
and <span class="math inline">\(x0\)</span>.</p>
<p>The predicted values of <span class="math inline">\(x\)</span> and
<span class="math inline">\(y\)</span>, <span class="math inline">\(\hat{X}\)</span> and <span class="math inline">\(\hat{Y}\)</span>, respectively, are computed
by</p>
<p><span class="math display">\[
\hat{X} = X\beta_{x},
\]</span> <span class="math display">\[
\hat{Y} = Y\beta_{y}.
\]</span></p>
<p>where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are column vectors of the values of
<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>The residuals of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are computed:</p>
<p><span class="math display">\[
E_{x} = X - \hat{X},
\]</span> <span class="math display">\[
E_{y} = Y - \hat{Y}.
\]</span></p>
<p>That is, they computed as in multiple regression although the
model-implied covariance matrix is used to compute the regression
coefficient. Simple standardized residuals (standardized by their
standard deviations, without correction as in studentized residuals in
multiple regression) are also stored.</p>
</div>
<div class="section level3">
<h3 id="fixed-to-zero-path">Fixed-to-Zero Path<a class="anchor" aria-label="anchor" href="#fixed-to-zero-path"></a>
</h3>
<p>For a path fixed to zero, if <code>add_path</code> is
<code>FALSE</code> (the default), the <code><a href="../reference/casewise_residuals.html">casewise_residuals()</a></code>
will do nothing. If <code>add_path</code> is <code>TRUE</code>, and the
<span class="math inline">\(y\)</span> variable does not point to <span class="math inline">\(x\)</span> in the model[^This prevents adding a
bidirectional path], then it will add a <code>path</code> from <span class="math inline">\(x\)</span> to <span class="math inline">\(y\)</span> and fit the model again. The residuals
for <span class="math inline">\(x\)</span> an <span class="math inline">\(y\)</span> will then be computed as for free paths
in the model and stored.</p>
<p>Note that this is done simply by adding <code>y ~ x</code> to the
model. Functions like <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> may fix or free other
parameters and so the model being fitted may not differ from the
original model by one degree of freedom. The purpose of this step is
purely for exploration.</p>
</div>
<div class="section level3">
<h3 id="x-and-y-are-identical">
<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are Identical<a class="anchor" aria-label="anchor" href="#x-and-y-are-identical"></a>
</h3>
<p>If <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are the same variable, then the
residuals of <span class="math inline">\(y\)</span> when being predicted
by other variables pointing to it are computed and stored, using the
regression coefficients in the model.</p>
</div>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<p>Note that these residuals are model based but lack the adjustments
usually done in multiple regression. To our knowledge, these adjustments
have not be extended to path analysis. Nevertheless, these residuals are
still useful for graphical assessment of linearity and identification of
unusual cases with respect to a model.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Shu Fai Cheung, Mark Hok Chio Lai, Rongwei Sun.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
